<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tailoring Shop Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f4f7f9; }
        .input-style {
            @apply w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 transition duration-150;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .summary-card {
            @apply p-4 rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl;
        }
        .status-badge {
            @apply px-2 py-1 rounded-full text-xs font-medium;
        }
        .status-pending { @apply bg-yellow-100 text-yellow-800; }
        .status-in-progress { @apply bg-blue-100 text-blue-800; }
        .status-completed { @apply bg-green-100 text-green-800; }
        .status-delivered { @apply bg-purple-100 text-purple-800; }
        .status-review { @apply bg-red-100 text-red-800; }
        .note-input {
            @apply flex items-center justify-between mb-2 p-2 bg-gray-50 rounded-lg;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .modal.active {
            display: flex;
        }
        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .measurement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
        }
        .search-container {
            position: relative;
        }
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 10;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .search-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
        }
        .search-item:hover {
            background-color: #f9fafb;
        }
        .product-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            z-index: 1001;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .notification.success {
            background-color: #10b981;
        }
        .notification.error {
            background-color: #ef4444;
        }
        .notification.warning {
            background-color: #f59e0b;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="max-w-7xl mx-auto p-4 md:p-8">
        <!-- Header -->
        <header class="bg-indigo-700 text-white p-4 rounded-xl mb-6 shadow-xl">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-extrabold flex items-center">
                    <i class="fas fa-ruler-combined mr-3 text-yellow-300"></i> Tailor Shop Manager
                </h1>
                <div class="flex items-center space-x-4">
                    <select id="measurementUnit" class="bg-indigo-600 border border-indigo-500 rounded-lg px-3 py-1 text-sm focus:ring-2 focus:ring-yellow-300">
                        <option value="imperial">Inches</option>
                        <option value="metric">Centimeters</option>
                    </select>
                    <div class="text-xs opacity-75 hidden sm:block">
                        <p>Manager ID: <span id="managerId" class="font-mono text-yellow-300">Loading...</span></p>
                    </div>
                </div>
            </div>
        </header>

        <!-- Notification -->
        <div id="notification" class="notification hidden"></div>

        <!-- Navigation Tabs -->
        <nav class="bg-white shadow-lg rounded-lg mb-6">
            <div class="flex flex-wrap">
                <button class="tab-btn flex-1 py-3 text-center text-md font-semibold border-b-4 transition duration-300 border-indigo-600 text-indigo-700" data-tab="dashboard">
                    <i class="fas fa-tachometer-alt mr-2"></i> Dashboard
                </button>
                <button class="tab-btn flex-1 py-3 text-center text-md font-semibold border-b-4 transition duration-300 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" data-tab="clients">
                    <i class="fas fa-users mr-2"></i> Clients
                </button>
                <button class="tab-btn flex-1 py-3 text-center text-md font-semibold border-b-4 transition duration-300 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" data-tab="orders">
                    <i class="fas fa-clipboard-list mr-2"></i> Orders
                </button>
                <button class="tab-btn flex-1 py-3 text-center text-md font-semibold border-b-4 transition duration-300 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" data-tab="products">
                    <i class="fas fa-tshirt mr-2"></i> Designs
                </button>
                <button class="tab-btn flex-1 py-3 text-center text-md font-semibold border-b-4 transition duration-300 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" data-tab="revenue">
                    <i class="fas fa-chart-bar mr-2"></i> Revenue
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main>
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <div class="bg-white p-6 rounded-2xl shadow-2xl">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Tailoring Shop Overview</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="summary-card bg-blue-50 border border-blue-200">
                            <div class="text-blue-600 text-sm font-medium">Total Revenue</div>
                            <div id="totalTailoringRevenue" class="text-2xl font-bold text-blue-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-green-50 border border-green-200">
                            <div class="text-green-600 text-sm font-medium">Net Profit</div>
                            <div id="tailoringNetProfit" class="text-2xl font-bold text-green-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-purple-50 border border-purple-200">
                            <div class="text-purple-600 text-sm font-medium">Outstanding Balance</div>
                            <div id="outstandingBalance" class="text-2xl font-bold text-purple-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-orange-50 border border-orange-200">
                            <div class="text-orange-600 text-sm font-medium">Inventory Value</div>
                            <div id="totalInventoryValueDisplay" class="text-2xl font-bold text-orange-800 mt-1">--</div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="summary-card bg-yellow-50 border border-yellow-200">
                            <div class="text-yellow-600 text-sm font-medium">Pending Orders</div>
                            <div id="pendingOrders" class="text-2xl font-bold text-yellow-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-blue-50 border border-blue-200">
                            <div class="text-blue-600 text-sm font-medium">In Progress</div>
                            <div id="inProgressOrders" class="text-2xl font-bold text-blue-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-green-50 border border-green-200">
                            <div class="text-green-600 text-sm font-medium">Completed</div>
                            <div id="completedOrders" class="text-2xl font-bold text-green-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-red-50 border border-red-200">
                            <div class="text-red-600 text-sm font-medium">Total Expenses</div>
                            <div id="totalTailoringExpensesDisplay" class="text-2xl font-bold text-red-800 mt-1">--</div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <button class="bg-blue-600 text-white p-4 rounded-xl shadow-lg hover:bg-blue-700 transition flex items-center justify-center" onclick="switchTab('orders')">
                            <i class="fas fa-plus-circle mr-2"></i> New Order
                        </button>
                        <button class="bg-green-600 text-white p-4 rounded-xl shadow-lg hover:bg-green-700 transition flex items-center justify-center" onclick="switchTab('clients')">
                            <i class="fas fa-user-plus mr-2"></i> Add Client
                        </button>
                        <button class="bg-purple-600 text-white p-4 rounded-xl shadow-lg hover:bg-purple-700 transition flex items-center justify-center" onclick="switchTab('products')">
                            <i class="fas fa-tshirt mr-2"></i> Add Design
                        </button>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-white p-6 rounded-xl border border-gray-300 shadow-sm">
                        <h3 class="text-lg font-bold text-gray-700 mb-4">Recent Activity</h3>
                        <div id="recentActivity" class="space-y-3">
                            <div class="text-gray-500 italic text-center py-4">Loading recent activity...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Clients Tab -->
            <div id="clients" class="tab-content">
                <div class="bg-white p-6 rounded-2xl shadow-2xl">
                    <div class="flex flex-col sm:flex-row justify-between items-center space-y-3 sm:space-y-0 mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Client Management</h2>
                        <div class="flex space-x-2 w-full sm:w-auto">
                            <button onclick="exportClients()" class="flex-1 sm:flex-none flex items-center justify-center py-2 px-4 text-sm font-semibold rounded-lg text-indigo-600 border border-indigo-300 hover:bg-indigo-50 transition shadow-md">
                                <i class="fas fa-download mr-2"></i> Export
                            </button>
                            <button onclick="openClientModal()" class="flex-1 sm:flex-none flex items-center justify-center py-2 px-4 border border-transparent text-sm font-bold rounded-lg shadow-lg text-white bg-green-600 hover:bg-green-700 transition">
                                <i class="fas fa-plus mr-2"></i> Add Client
                            </button>
                        </div>
                    </div>

                    <!-- Search -->
                    <div class="mb-6">
                        <div class="search-container">
                            <div class="flex items-center">
                                <i class="fas fa-search text-gray-500 mr-3"></i>
                                <input type="text" id="clientSearch" placeholder="Search clients by name or phone..." class="w-full p-3 border border-gray-300 rounded-xl shadow-inner focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
                            </div>
                            <div id="clientSearchResults" class="search-results hidden"></div>
                        </div>
                    </div>

                    <!-- Clients List -->
                    <div id="clientsList" class="space-y-4">
                        <div class="text-gray-500 italic text-center py-8">No clients found</div>
                    </div>
                </div>
            </div>

            <!-- Orders Tab -->
            <div id="orders" class="tab-content">
                <div class="bg-white p-6 rounded-2xl shadow-2xl">
                    <div class="flex flex-col sm:flex-row justify-between items-center space-y-3 sm:space-y-0 mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Order Management</h2>
                        <div class="flex space-x-2 w-full sm:w-auto">
                            <button onclick="exportOrders()" class="flex-1 sm:flex-none flex items-center justify-center py-2 px-4 text-sm font-semibold rounded-lg text-indigo-600 border border-indigo-300 hover:bg-indigo-50 transition shadow-md">
                                <i class="fas fa-download mr-2"></i> Export
                            </button>
                            <button onclick="openOrderModal()" class="flex-1 sm:flex-none flex items-center justify-center py-2 px-4 border border-transparent text-sm font-bold rounded-lg shadow-lg text-white bg-green-600 hover:bg-green-700 transition">
                                <i class="fas fa-plus mr-2"></i> New Order
                            </button>
                        </div>
                    </div>

                    <!-- Search and Filters -->
                    <div class="mb-6 space-y-4">
                        <div class="search-container">
                            <div class="flex items-center">
                                <i class="fas fa-search text-gray-500 mr-3"></i>
                                <input type="text" id="orderSearch" placeholder="Search orders by client name or phone..." class="w-full p-3 border border-gray-300 rounded-xl shadow-inner focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
                            </div>
                        </div>

                        <!-- Enhanced Filters -->
                        <div class="bg-white p-4 rounded-xl border border-gray-200">
                            <div class="flex items-center justify-between mb-3">
                                <h3 class="text-lg font-semibold text-gray-700 flex items-center">
                                    <i class="fas fa-filter mr-2"></i> Filters
                                </h3>
                                <button onclick="clearOrderFilters()" class="text-sm text-indigo-600 hover:text-indigo-800 font-medium">
                                    Clear All
                                </button>
                            </div>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
                                <select id="filterStatus" class="p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                                    <option value="">All Statuses</option>
                                    <option value="pending">Pending</option>
                                    <option value="in-progress">In Progress</option>
                                    <option value="completed">Completed</option>
                                    <option value="delivered">Delivered</option>
                                    <option value="review">Review</option>
                                </select>

                                <select id="filterOrderType" class="p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                                    <option value="">All Types</option>
                                    <option value="Production Order">Production Order</option>
                                    <option value="Alteration">Alteration</option>
                                </select>

                                <select id="filterDateRange" class="p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                                    <option value="">Any Date</option>
                                    <option value="today">Today</option>
                                    <option value="week">Last 7 Days</option>
                                    <option value="month">Last 30 Days</option>
                                </select>

                                <input type="number" id="filterMinPrice" placeholder="Min Price" class="p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                                <input type="number" id="filterMaxPrice" placeholder="Max Price" class="p-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                            </div>
                        </div>
                    </div>

                    <!-- Orders List -->
                    <div id="ordersList" class="space-y-4">
                        <div class="text-gray-500 italic text-center py-8">No orders found</div>
                    </div>
                </div>
            </div>

            <!-- Products Tab -->
            <div id="products" class="tab-content">
                <div class="bg-white p-6 rounded-2xl shadow-2xl">
                    <div class="flex flex-col sm:flex-row justify-between items-center space-y-3 sm:space-y-0 mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Design Catalog</h2>
                        <div class="flex space-x-2 w-full sm:w-auto">
                            <button onclick="exportProducts()" class="flex-1 sm:flex-none flex items-center justify-center py-2 px-4 text-sm font-semibold rounded-lg text-indigo-600 border border-indigo-300 hover:bg-indigo-50 transition shadow-md">
                                <i class="fas fa-download mr-2"></i> Export
                            </button>
                            <button onclick="openProductModal()" class="flex-1 sm:flex-none flex items-center justify-center py-2 px-4 border border-transparent text-sm font-bold rounded-lg shadow-lg text-white bg-green-600 hover:bg-green-700 transition">
                                <i class="fas fa-plus mr-2"></i> Add Design
                            </button>
                        </div>
                    </div>

                    <!-- Search -->
                    <div class="mb-6">
                        <div class="search-container">
                            <div class="flex items-center">
                                <i class="fas fa-search text-gray-500 mr-3"></i>
                                <input type="text" id="productSearch" placeholder="Search designs by name or category..." class="w-full p-3 border border-gray-300 rounded-xl shadow-inner focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
                            </div>
                        </div>
                    </div>

                    <!-- Products Grid -->
                    <div id="productsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="text-gray-500 italic text-center py-8 col-span-3">No designs found</div>
                    </div>
                </div>
            </div>

            <!-- Revenue Tab -->
            <div id="revenue" class="tab-content">
                <div class="bg-white p-6 rounded-2xl shadow-2xl">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">Financial Overview</h2>
                        <button onclick="exportFinancialReport()" class="flex items-center justify-center py-2 px-4 text-sm font-semibold rounded-lg text-indigo-600 border border-indigo-300 hover:bg-indigo-50 transition shadow-md">
                            <i class="fas fa-download mr-2"></i> Export Report
                        </button>
                    </div>

                    <!-- Revenue Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="summary-card bg-green-50 border border-green-200">
                            <div class="text-green-600 text-sm font-medium">Realized Revenue</div>
                            <div id="realizedRevenue" class="text-2xl font-bold text-green-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-yellow-50 border border-yellow-200">
                            <div class="text-yellow-600 text-sm font-medium">Pending Revenue</div>
                            <div id="pendingRevenue" class="text-2xl font-bold text-yellow-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-indigo-50 border border-indigo-200">
                            <div class="text-indigo-600 text-sm font-medium">Total Potential Revenue</div>
                            <div id="totalPotentialRevenue" class="text-2xl font-bold text-indigo-800 mt-1">--</div>
                        </div>
                    </div>

                    <!-- Order Metrics -->
                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-6 mb-8">
                        <div class="summary-card bg-white border border-gray-200">
                            <div class="text-gray-600 text-sm font-medium">Total Orders</div>
                            <div id="totalOrdersCount" class="text-2xl font-bold text-gray-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-white border border-gray-200">
                            <div class="text-gray-600 text-sm font-medium">Completed Orders</div>
                            <div id="completedOrdersCount" class="text-2xl font-bold text-gray-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-white border border-gray-200">
                            <div class="text-gray-600 text-sm font-medium">Design Orders</div>
                            <div id="designOrdersCount" class="text-2xl font-bold text-gray-800 mt-1">--</div>
                        </div>
                        <div class="summary-card bg-white border border-gray-200">
                            <div class="text-gray-600 text-sm font-medium">Custom Orders</div>
                            <div id="customOrdersCount" class="text-2xl font-bold text-gray-800 mt-1">--</div>
                        </div>
                    </div>

                    <!-- Status Breakdown -->
                    <div class="bg-white p-6 rounded-xl border border-gray-300 shadow-sm">
                        <h3 class="text-lg font-bold text-gray-700 mb-4">Status Breakdown</h3>
                        <div id="statusBreakdown" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <!-- Status breakdown will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Client Modal -->
    <div id="clientModal" class="modal">
        <div class="modal-content w-full max-w-2xl">
            <div class="p-6 border-b border-gray-100 flex justify-between items-center bg-indigo-50 rounded-t-xl">
                <h2 class="text-2xl font-bold text-indigo-800 flex items-center">
                    <i class="fas fa-user mr-3"></i> <span id="clientModalTitle">Add New Client</span>
                </h2>
                <button onclick="closeClientModal()" class="text-gray-500 hover:text-red-500 transition p-2 rounded-full hover:bg-red-50">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="clientForm" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="text-sm font-medium text-gray-700">Full Name *</label>
                            <input type="text" id="clientName" class="input-style" required>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-gray-700">Phone Number *</label>
                            <input type="tel" id="clientPhone" class="input-style" required>
                        </div>
                        <div class="md:col-span-2">
                            <label class="text-sm font-medium text-gray-700">Location/Address</label>
                            <input type="text" id="clientLocation" class="input-style">
                        </div>
                        <div class="md:col-span-2">
                            <label class="text-sm font-medium text-gray-700">Notes</label>
                            <textarea id="clientNotes" class="input-style" rows="2"></textarea>
                        </div>
                    </div>

                    <!-- Measurements Section -->
                    <div class="border border-indigo-200 p-4 rounded-xl bg-indigo-50 space-y-4">
                        <h3 class="text-lg font-semibold text-indigo-700 flex items-center">
                            <i class="fas fa-ruler mr-2"></i> Measurements Profile (<span id="measurementUnitLabel">inches</span>)
                        </h3>
                        <div id="clientMeasurementsContainer" class="space-y-3">
                            <!-- Measurements will be added here dynamically -->
                        </div>
                        <button type="button" onclick="addMeasurementField()" class="w-full flex items-center justify-center py-2 px-4 text-sm font-semibold rounded-lg text-indigo-600 border border-indigo-300 hover:bg-indigo-100 transition">
                            <i class="fas fa-plus mr-2"></i> Add Measurement Field
                        </button>
                    </div>

                    <button type="submit" class="w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition">
                        Save Client
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Order Modal -->
    <div id="orderModal" class="modal">
        <div class="modal-content w-full max-w-4xl">
            <div class="p-6 border-b border-gray-100 flex justify-between items-center bg-indigo-50 rounded-t-xl">
                <h2 class="text-2xl font-bold text-indigo-800 flex items-center">
                    <i class="fas fa-plus mr-3"></i> New Client Order Entry
                </h2>
                <button onclick="closeOrderModal()" class="text-gray-500 hover:text-red-500 transition p-2 rounded-full hover:bg-red-50">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="orderForm" class="space-y-6">
                    <!-- Client Selection -->
                    <div class="bg-indigo-50 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-indigo-600 mb-4 flex items-center">
                            <i class="fas fa-user mr-2"></i> 1. Select or Add Client
                        </h3>
                        <div class="space-y-4">
                            <div>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" id="isNewClient" onchange="toggleNewClient()">
                                    <span class="text-lg font-medium text-gray-700">Add a New Client for this order</span>
                                </label>
                            </div>
                            <div id="existingClientSection">
                                <label class="text-sm font-medium text-gray-700">Select Existing Client</label>
                                <select id="orderClientId" class="input-style">
                                    <option value="">-- Choose a Client --</option>
                                </select>
                            </div>
                            <div id="newClientSection" class="hidden grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="text-sm font-medium text-gray-700">Full Name *</label>
                                    <input type="text" id="newClientName" class="input-style">
                                </div>
                                <div>
                                    <label class="text-sm font-medium text-gray-700">Phone Number *</label>
                                    <input type="tel" id="newClientPhone" class="input-style">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Design Selection -->
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-indigo-600 mb-4 flex items-center">
                            <i class="fas fa-tshirt mr-2"></i> 2. Select Design (Optional)
                        </h3>
                        <div>
                            <label class="text-sm font-medium text-gray-700">Choose from Existing Designs</label>
                            <select id="orderProductId" class="input-style" onchange="handleProductSelection()">
                                <option value="">-- Custom Order (No Design) --</option>
                            </select>
                        </div>
                    </div>

                    <!-- Order Details -->
                    <div class="bg-indigo-50 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-indigo-600 mb-4 flex items-center">
                            <i class="fas fa-ruler mr-2"></i> 3. Order Type and Garment
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="text-sm font-medium text-gray-700">Order Type</label>
                                <select id="orderType" class="input-style" onchange="toggleMeasurements()">
                                    <option value="Production Order">Production Order</option>
                                    <option value="Alteration">Alteration</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-700">Garment / Item</label>
                                <select id="garmentType" class="input-style" onchange="updateMeasurementFields()">
                                    <option value="Shirt">Shirt</option>
                                    <option value="Trousers">Trousers</option>
                                    <option value="Jacket">Jacket</option>
                                    <option value="Kurta">Kurta</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-700">Order Price (MWK) *</label>
                                <input type="number" id="orderPrice" class="input-style" step="0.01" min="0" required>
                            </div>
                        </div>
                    </div>

                    <!-- Measurements -->
                    <div id="measurementsSection" class="bg-indigo-50 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-indigo-600 mb-4 flex items-center">
                            <i class="fas fa-ruler mr-2"></i> 4. <span id="garmentTypeLabel">Shirt</span> Measurements (<span id="orderMeasurementUnitLabel">inches</span>)
                        </h3>
                        <div id="measurementsContainer" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4">
                            <!-- Measurement fields will be populated here -->
                        </div>
                    </div>

                    <!-- Notes and Status -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="text-sm font-medium text-gray-700">Initial Job Status</label>
                            <select id="orderStatus" class="input-style">
                                <option value="pending">Pending</option>
                                <option value="in-progress">In Progress</option>
                                <option value="completed">Completed</option>
                                <option value="review">Review</option>
                            </select>
                        </div>
                        <div class="md:col-span-2">
                            <label class="text-sm font-medium text-gray-700">Order Notes</label>
                            <textarea id="orderNotes" class="input-style" rows="3" placeholder="E.g., High collar, double-stitched pockets, fabric type..."></textarea>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition">
                        Save Order
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content w-full max-w-2xl">
            <div class="p-6 border-b border-gray-100 flex justify-between items-center bg-indigo-50 rounded-t-xl">
                <h2 class="text-2xl font-bold text-indigo-800 flex items-center">
                    <i class="fas fa-tshirt mr-3"></i> <span id="productModalTitle">Add New Design</span>
                </h2>
                <button onclick="closeProductModal()" class="text-gray-500 hover:text-red-500 transition p-2 rounded-full hover:bg-red-50">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="productForm" class="space-y-4">
                    <!-- Image Upload -->
                    <div>
                        <label class="text-sm font-medium text-gray-700">Design Image</label>
                        <input type="file" id="productImage" accept="image/*" class="input-style">
                        <div id="imagePreview" class="mt-2"></div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="text-sm font-medium text-gray-700">Design Name *</label>
                            <input type="text" id="productName" class="input-style" required>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-gray-700">Category *</label>
                            <select id="productCategory" class="input-style" required>
                                <option value="">Select Category</option>
                                <option value="Shirt">Shirt</option>
                                <option value="Trousers">Trousers</option>
                                <option value="Jacket">Jacket</option>
                                <option value="Kurta">Kurta</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-gray-700">Price (MWK) *</label>
                            <input type="number" id="productPrice" class="input-style" step="0.01" min="0" required>
                        </div>
                    </div>

                    <div>
                        <label class="text-sm font-medium text-gray-700">Description</label>
                        <textarea id="productDescription" class="input-style" rows="3"></textarea>
                    </div>

                    <!-- Required Measurements -->
                    <div class="border border-indigo-200 p-4 rounded-xl bg-indigo-50 space-y-4">
                        <h3 class="text-lg font-semibold text-indigo-700 flex items-center">
                            <i class="fas fa-ruler mr-2"></i> Required Measurements (<span id="productMeasurementUnitLabel">inches</span>)
                        </h3>
                        <div id="productMeasurementsContainer" class="space-y-3">
                            <!-- Measurement fields will be added here -->
                        </div>
                        <button type="button" onclick="addProductMeasurementField()" class="w-full flex items-center justify-center py-2 px-4 text-sm font-semibold rounded-lg text-indigo-600 border border-indigo-300 hover:bg-indigo-100 transition">
                            <i class="fas fa-plus mr-2"></i> Add Measurement Field
                        </button>
                    </div>

                    <button type="submit" class="w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition">
                        Save Design
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Order Detail Modal -->
    <div id="orderDetailModal" class="modal">
        <div class="modal-content w-full max-w-2xl">
            <!-- Content will be populated dynamically -->
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script type="module">
        // ... (The complete JavaScript code from the previous implementation would go here)
        // This would include all the Firebase initialization, data management functions,
        // event handlers, and the enhanced TailoringManager class with all the new features
    </script>

    <script>
        // Tab management
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-indigo-600', 'text-indigo-700');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Activate current tab button
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('border-indigo-600', 'text-indigo-700');
            document.querySelector(`[data-tab="${tabName}"]`).classList.remove('border-transparent', 'text-gray-500');
        }

        // Initialize tab buttons
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                switchTab(btn.getAttribute('data-tab'));
            });
        });

        // Modal management functions
        function openClientModal() {
            document.getElementById('clientModal').classList.add('active');
        }

        function closeClientModal() {
            document.getElementById('clientModal').classList.remove('active');
        }

        function openOrderModal() {
            document.getElementById('orderModal').classList.add('active');
        }

        function closeOrderModal() {
            document.getElementById('orderModal').classList.remove('active');
        }

        function openProductModal() {
            document.getElementById('productModal').classList.add('active');
        }

        function closeProductModal() {
            document.getElementById('productModal').classList.remove('active');
        }

        // Utility functions
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.remove('hidden');
            
            setTimeout(() => {
                notification.classList.add('hidden');
            }, 5000);
        }

        // Close modals when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>
